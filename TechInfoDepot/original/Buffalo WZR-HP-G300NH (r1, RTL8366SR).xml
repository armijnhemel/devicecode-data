<page>
    <title>Buffalo WZR-HP-G300NH (r1, RTL8366SR)</title>
    <ns>0</ns>
    <id>4078</id>
    <revision>
      <id>376343</id>
      <parentid>364858</parentid>
      <timestamp>2024-08-15T13:26:52Z</timestamp>
      <contributor>
        <username>ShadowBot</username>
        <id>3357272</id>
      </contributor>
      <minor/>
      <comment>/* top */clean up</comment>
      <origin>376343</origin>
      <model>wikitext</model>
      <format>text/x-wiki</format>
      <text bytes="26145" sha1="7ukqjo8oelhhup9a8o7geaq5v5xhmmo" xml:space="preserve">{{Infobox Embedded System
|image1             = Buffalo WZR-HP-G300NH.jpg
|image1_size        = 200px
|caption            = Buffalo AirStation HighPower N300
|caption2           = &lt;!-- 2nd tagleine --&gt;
|pp                 = &lt;!-- product page url only --&gt;
|sp                 = &lt;!-- Support page url only --&gt;
|dl                 = &lt;!-- Download page url only --&gt;
|fandom             = Buffalo_WZR-HP-G300NH_v1.0
|wikidevi           = Buffalo_WZR-HP-G300NH_(r1,_RTL8366SR)
|wikipedia          = &lt;!-- [[wikipedia:Main Page|Wikipedia]] Leave blank for none --&gt;
|ddwrtsupport       = Supported
|openwrtsupport     = Supported
|tomatosupport      = &lt;!-- Incompatible, Not Supported, Partial Support, Supported, WIP, Unofficially, --&gt;
|gargoylesupport    = &lt;!-- Incompatible, Not Supported, Partial Support, Supported, WIP, Unofficially, --&gt;

|brand              = Buffalo
|model              = WZR-HP-G300NH
|submodelappend     = &lt;!-- yes, for space --&gt;
|submodel           = &lt;!-- SubModel number, Leave blank for unknown --&gt;
|revision           = (r1, RTL8366SR)
|subrevision        = &lt;!-- Model Subrevision, Leave blank for none or unknown --&gt;
|model_part_num     = 
|page_start_date    = 09/04/2010
|page_start_origon  = https://infodepot.fandom.com/wiki/Buffalo_WZR-HP-G300NH_v1.0
|wlclass            = N300
|series             = &lt;!-- Device series --&gt;
|type               = wireless router
|sernum             = &lt;!-- First 4 or so for easy version identification --&gt;
|fcc_id             = FDI-09101560-0
|icid               = 6102A-021
|us_id              = &lt;!-- US ID number --&gt;
|boardid            = &lt;!-- Board Identification, Leave blank for none --&gt;
|ecc_id             = &lt;!-- eec-id --&gt;

|cpu1chip1          = Atheros;AR9132;
|cpu1_cores         = 1
|cpu1_type          = MIPS 24K
|cpu1_type_rev      = &lt;!-- CPU1 type Revision, Leave blank for unknown --&gt;
|cpu1spd            = 400
|is_doc             = 
|bus                = &lt;!-- 8-bit, 16-bit, 32-bit, 64-bit, Leave blank for none --&gt;

|flash1type         = Parallel
|fla1_num           = &lt;!-- 1,2,3,4 --&gt;
|fla1chip           = &lt;!-- Brand;Model;Extra, info; --&gt;
|flash1size         = 32
|flash1maxsize      = &lt;!-- Maximum size firmware can be in bytes --&gt;

|ram1type           = &lt;!-- DDR,DDR2,DDR3,DDR4, --&gt;
|ram1type1          = &lt;!-- SO-DIMM,SDRAM, --&gt;
|ram1spd            = &lt;!-- RAM speed --&gt;
|ram1size           = 64
|ram1chip           = &lt;!-- Brand;Model;Extra, info; --&gt;
|ram1_num           = &lt;!-- Number of Ram chips --&gt;
|nvramsize          = &lt;!-- 32, 60, 64, etc... in kb, Leave blank for unknown --&gt;

|eth_cpu            = true
|sw1chip            = Realtek;RTL8366SR;
|wan_ports          = 1
|wan_speed          = 1GbE
|lan_ports          = 4
|lan_speed          = 1GbE
|ethstandard        = IEEE 802.3/3u/3ab
|portbasedvlan      = &lt;!-- Support for port based vlan tagging, Leave blank for unknown --&gt;
|802.1qvlan         = &lt;!-- Support for 802.1q vlan tagging, Leave blank for unknown --&gt;
|auto_mdix          = &lt;!-- mdix support --&gt;
|sup_jumbo          = &lt;!-- Jumbo frames support --&gt;
|ethoui             = &lt;!-- Leave blank for unknown --&gt;
|oui                = &lt;!-- Wireless OUI --&gt;

|bootwait           = &lt;!-- On or Off, Leave blank for unknown --&gt;
|stockbootloader    = U-Boot;;;
|stockos            = &lt;!-- Name;Version;Distro --&gt;

|exp_if_types       = &lt;!-- Expansion Interface types, Leave blank for none --&gt;

|pwr_volt_type      = VDC
|pwr_vdc            = 12
|pwr_amp_dc         = 2
|pwr_conn           = barrel
|pwr_barrel_outer   = &lt;!-- Outer barrel size in mm --&gt;
|pwr_barrel_inner   = &lt;!-- Inner barrel size in mm --&gt;
|pwr_barrel_len     = &lt;!-- Length of barrel --&gt;
|pwr_pol            = &lt;!-- Connector polarity --&gt;

|serial             = yes
|jtag               = yes

|specialfeat        = &lt;!-- Features that don't fit any place else, Leave blank for none --&gt;
|flags              = &lt;!-- flags, Leave blank for none --&gt;
|addchip            = &lt;!-- Additional Chips --&gt;
|802dot11_protocols = bgn

|defaulip           = &lt;!-- ???.???.???.???, default IP Address --&gt;
|defaultlogin       = &lt;!-- default Login Name, Leave blank for unknown --&gt;
|defaultpass        = &lt;!-- default Password, Leave blank for unknown --&gt;
|defaultssid        = &lt;!-- default Wireless ID, Leave blank for unknown --&gt;
|defaultssid_regex  = 
|default_ch         = &lt;!-- Defaults channel(s) Radio(s) are set to --&gt;
|manuf              = Cameo
|manuf_model        = &lt;!-- Manufacturer Model --&gt;
|manuf_rev          = &lt;!-- Manufacturer Revision --&gt;
|tpfirmware         = DD-WRT, LibreWrt, OpenWrt

|availability       = Discontinued
|eoldate            = 2016
|fccapprovdate      = 03/04/2009
|estreldate         = &lt;!-- Estimated release date --&gt;
|estprice           = &lt;!-- Estimated retail price in US dollars --&gt;
|upc                = &lt;!-- UPC number --&gt;
|ean                = &lt;!-- EAN number --&gt;
|dx_sku             = &lt;!-- DealExtreme sku --&gt;
|newegg             = &lt;!-- newegg item number --&gt;
|asin               = &lt;!-- ASIN number --&gt;
|asin_country       = &lt;!-- ASIN country --&gt;
|asin2              = &lt;!-- ASIN number --&gt;
|asin_country2      = &lt;!-- ASIN country --&gt;
|countrymanuf       = China

|buttons            = &lt;!-- buttons available --&gt;
|led                = &lt;!-- Led colors and descriptions --&gt;
|dimensions         = &lt;!-- Size of device {{convert |length|x|widthordepth|x|height|in|mm}} --&gt;
|weight             = &lt;!-- Weight of device {{convert|weight|oz|g}} --&gt;

|wi1_if_name        = 
|rad1chip1cpu       = true
|rad1chip2          = Atheros;AR9103;
|rad1oui            = &lt;!-- Only if different from above OUI --&gt; 
|rad1_ant_conn      = U.FL
|rad1txchains       = 2
|rad1rxchains       = 3
|rad1sstreams       = 2
|rad1stand          = IEEE 802.11b/g/n
|rad1n              = 300
|rad1g              = 54
|rad1b              = 11
|rad1freq           = 2.4

}}{{TIDTOC|embedded}}
==Overview==
The device appears to be a Cameo product.

==Links of Interest==
*[https://openwrt.org/toh/hwdata/buffalo/buffalo_wzr-hp-g300nh_v1 On the OpenWrt wiki]
*[http://dd-wrt.com/wiki/index.php/Buffalo_WZR-HP-G300NH On the DD-WRT wiki]
*[http://www.dd-wrt.com/phpBB2/viewtopic.php?t=85847 Easy MiniDLNA for WZR-HP-G300NH]

==Flashing==
{{Flashnotice}}
===Flashing dd-wrt===
Supported by dd-wrt as of = v24sp2 v13525 20091228

[[Buffalo WZR-HP-G300NH (r1, RTL8366SR)/dd-wrt|Flashing WZR-HP-G300NH]]

Buffalo provides a re-branded version of DD-WRT specifically for this router.  It can be flashed from the GUI and is available on the Buffalo website:

http://www.buffalotech.com/support/getfile/wzrhpg300nh-pro-v24sp2-14998.zip

Read Me Documentation for Buffalo delivered DD-WRT firmware:
http://www.buffalotech.com/support/getfile/wzrhpg300nh-pro-v24sp2-14998.txt
 
As of Feb 2010, the WZR-HP-G300NH can be flashed with DD-WRT directly from the Buffalo web GUI.  To do this, go to http://www.dd-wrt.com/site/support/router-database, look up ''Buffalo WZR-HP-G300NH'', and download the firmware file you need (just one file).
* The ''buffalo to ddwrt webflash'' file is a full build.  It's for flashing from the original Buffalo firmware to DD-WRT. 
* The ''webupgrade file'' is to upgrade from an older version of DD-WRT.  Use this to upgrade from an old version of DD-WRT.
*To revert from DD-WRT back to stock firmware, go to http://www.dd-wrt.com/phpBB2/download.php?id=13418, and download the file. Flash using upgrade on the DD-WRT  web GUI. This is the 1.6 stock firmware. You can then upgrade to the latest Buffalo firmware. '''You must be signed into the forum first, sign in then click the link for the webgui revert file. See the forums for details.  Register and log in to see and download files.'''
* http://www.dd-wrt.com/phpBB2/viewtopic.php?t=63820&amp;postdays=0&amp;postorder=asc&amp;highlight=13977&amp;start=90.
* http://www.dd-wrt.com/phpBB2/viewtopic.php?t=66494&amp;postdays=0&amp;postorder=asc&amp;start=30.  Details on reverting the firmware.

====DD-WRT on Buffalo WZR-HP-G300NH (Japanese version)====

The official DD-WRT release cannot be pushed by web upload onto the Japanese WZR-HP-G300NH original Buffalo firmware.  Buffalo Japan added a &quot;safeguard&quot; that checks for Japanese firmware and rejects western firmware.  For people with a Japanese router, see the following two sites for details.
* http://www.dd-wrt.com/phpBB2/viewtopic.php?t=63820&amp;postdays=0&amp;postorder=asc&amp;highlight=13977&amp;start=90
* http://www.dd-wrt.com/phpBB2/viewtopic.php?t=66494&amp;postdays=0&amp;postorder=asc&amp;start=30

====Debricking Info====
There have been a few guides out that have reports of success when de-bricking the WZR-HP-G300NH. This however, has been explained by Brainslayer in this post, please use it for referencing info you may need to de-brick your unit, should the occasion arise.

http://www.dd-wrt.com/phpBB2/viewtopic.php?t=87579

===Flashing OpenWrt===
{{OpenWrt
|techdata                  = https://openwrt.org/toh/hwdata/buffalo/buffalo_wzr-hp-g300nh_v1
|wikipage                  = https://openwrt.org/toh/buffalo/wzr-hp-g300h
|forumpage                 = https://forum.openwrt.org/viewtopic.php?id=24052
|forumpage2                = 
|forumpage3                = 
|github                    = 
|target                    = 
|subtarget                 = 
|arch                      = 
|support_started_version   = 10.03.1
|current_supported_version = 23.05.2
|unsupportedfuncntions     = 
|comment                   = 
}}
:[[Buffalo WZR-HP-G300NH (r1, RTL8366SR)/OpenWrt|Flashing WZR-HP-G300NH]]
Please insert instructions here

==USB Info==
===Samba Configuration===
&lt;b&gt;The latest build has already include simple UI to configure Samba&lt;/b&gt;&lt;br&gt;
DD-WRT already includes a built-in Samba server, but is missing UI to configure it.  These instructions provide a simple way to setup Samba.  They are based on instructions from http://g300nh.blogspot.com/2010/06/samba-sharing-in-dd-wrt.html, but have been modified for users not familiar with Linux.  All setup can be done from within the DD-WRT interface without requiring the use of a remote shell.

====Pre Requirements====
DD-WRT doesn't have any tools to format an HDD, so you must have an preformatted HDD in a format that DD-WRT can understand (FAT32, EXT3, etc.)

Go to Services/USB within DD-WRT and change the settings as indicated below:
&lt;pre&gt;
Core USB Support: Enable
USB 2.0 Support: Enable 
USB Storage Support: Enable 
ext2 / ext3 File System Support: Enable
FAT File System Support: Enable
Automatic Drive Mount: Enable 
Disk Mount Point: /mnt
&lt;/pre&gt;

After apply the changes, if you have already plugged in an HDD, you should see its information in the UI.

====Anonymous Sharing Setup====
These step will share a disk that is already mounted at /mnt.  It will be publicly available to everyone on the network and won't require a username or password to connect.

Go to Administrators/Commands in DD-WRT and copy the script below into the textbox then choose Save Startup

&lt;pre&gt;
# Stop samba service
killall smbd
killall nmbd
sleep 2

# Configure samba
mkdir -p /tmp/etc/samba
echo &quot;
[global]
	netbios name = DD-WRT
	workgroup = WORKGROUP
	server string = DD-WRT
	syslog = 10
	obey pam restrictions = yes
	socket options = TCP_NODELAY
	preferred master = no
	os level = 20
	
	security = share
	guest account = nobody
	invalid users = root, mail, deamon, reboot
	null passwords = yes
	guest only = yes	
	map to guest = Bad User

	private dir = /tmp/etc/samba/
	lock directory = /var/lock/
	pid directory = /var/run/

	unix charset = UTF-8
	dos charset = UTF-8
	map archive = No
	map hidden = No
	map system = No

[Share]
	path = /mnt/
	read only = no
	create mask = 0700
	directory mask = 0700
&quot; &gt; /tmp/etc/samba/smb.conf

# Add user for samba
# guest user
grep -q nobody /etc/passwd || echo 'nobody:x:65534:65534:nobody:/mnt:/bin/false' &gt;&gt; /etc/passwd

# Start samba service
SMBOPTIONS=&quot;-s /tmp/etc/samba/smb.conf&quot;
/usr/sbin/smbd $SMBOPTIONS
/usr/sbin/nmbd $SMBOPTIONS
&lt;/pre&gt;

====Setup Sharing with Username/Password====
Because &lt;code&gt;smbpasswd&lt;/code&gt; program build-in DD-WRT always treats /etc/samba/smbpasswd as the samba password file, and /etc is a readonly file system, we must temporary bind /tmp/etc to /etc when adding a user. Change &lt;code&gt;# Add user for samba&lt;/code&gt; section like below:
&lt;pre&gt;
# Add user for samba
mount -o bind /tmp/etc /etc

# clear samba user if exists
echo &quot;&quot; &gt; /tmp/etc/samba/smbpasswd

# guest user
grep -q nobody /etc/passwd || echo 'nobody:x:65534:65534:nobody:/mnt:/bin/false' &gt;&gt; /etc/passwd

# add user: username=share, password=sharepassword
grep -q share /etc/passwd || echo 'share:x:65534:65534:nobody:/mnt/:/bin/false' &gt;&gt; /etc/passwd
smbpasswd share sharepassword

umount /etc
&lt;/pre&gt;

If you need add more users, you can repeat these lines with the desired usernames and passwords
&lt;pre&gt;
# add user: username=share, password=sharepassword
grep -q share /etc/passwd || echo 'share:x:65534:65534:nobody:/mnt/:/bin/false' &gt;&gt; /etc/passwd
smbpasswd share sharepassword
&lt;/pre&gt;

In the [global] section of Samba configuration, update the config value as indicated below:
&lt;pre&gt;
	encrypt passwords = true
	passdb backend = smbpasswd
	security = user
	null passwords = no
	guest only = no	
	smb passwd file = /tmp/etc/samba/smbpasswd
&lt;/pre&gt;
====Configuration Share Folder====
&lt;i&gt;add later&lt;/i&gt;
====Setup DD-WRT as Windows Name Server====
If your network has more than one subnet, you might need to setup a Windows Name Server (WINS server), You can make you router become a WINS server even if you don't have a USB HDD or you don't need a sharing setup. Just user script like &lt;code&gt;Anonymous Sharing Setup&lt;/code&gt; but change the below setting in the &lt;code&gt;[global]&lt;/code&gt; section:
&lt;pre&gt;
wins support = yes
&lt;/pre&gt;

Go to Setup/Basic section in DD-WRT and set WINS server in DHCP group to your LAN IP address (ex: 192.168.11.1)

If your network has any device that uses a static IP address, find the WINS section and point to DD-WRT LAN IP address (If you use Windows, choose properties of you adapter, click Advanced, goto WINS tag. If you use Linux, add &lt;code&gt;wins server = xxx.xxx.xxx.xxx&lt;/code&gt; in &lt;code&gt;[global]&lt;/code&gt; section of samba)
&lt;/div&gt;

===Optware on Atheros===
Running Optware on Atheros is somewhat different than broadcom. This post explains how to install and setup Optware on Atheros.

http://www.dd-wrt.com/phpBB2/viewtopic.php?t=86912

==Pictures==
&lt;center&gt;'''Images'''
&lt;gallery&gt;
File:Vigor2600vgsmacable.jpg|sma cable
File:WZR-HP-G300NHb.JPG|wireless card
File:WZR-HP-G300NHc.JPG|proc,flash and ram
&lt;/gallery&gt;&lt;/center&gt;[[Has images::internal| ]]
&lt;center&gt;'''FCCID {{fccid|FDI-09101560-0|FDI-09101560-0}}'''
&lt;gallery&gt;
File:Buffalo WZR-HP-G300NH v1.0 FCC a.png|
File:Buffalo WZR-HP-G300NH v1.0 FCC b.png|
File:Buffalo WZR-HP-G300NH v1.0 FCC c.png|
File:Buffalo WZR-HP-G300NH v1.0 FCC d.png|
File:Buffalo WZR-HP-G300NH v1.0 FCC e.png|
File:Buffalo WZR-HP-G300NH v1.0 FCC f.png|
File:Buffalo WZR-HP-G300NH v1.0 FCC g.png|
File:Buffalo WZR-HP-G300NH v1.0 FCC h.png|
File:Buffalo WZR-HP-G300NH v1.0 FCC i.png|
File:Buffalo WZR-HP-G300NH v1.0 FCC j.png|
File:Buffalo WZR-HP-G300NH v1.0 FCC k.png|
File:Buffalo WZR-HP-G300NH v1.0 FCC l.png|
File:Buffalo WZR-HP-G300NH v1.0 FCC m.png|
&lt;/gallery&gt;&lt;/center&gt;[[Has images::fcc| ]]

==Notes==
===Fix for WiFi Dropouts===
Many users of Buffalo DD-WRT (v24SP2) routers, like me, experience frequent WiFi dropouts, even after tweaking WiFi settings for strong reliable signals.

This startup script monitors a WiFi-connected device on your network that is always on to monitor WiFi dropouts.  If there are two missed pings, then it restarts the WiFi interface to restore the connection.  The script has been modified [http://www.dd-wrt.com/wiki/index.php/Useful_Scripts#Reset_Wireless_Radio from this one for Broadcom hardware], to get it to work on Atheros hardware.

[http://www.dd-wrt.com/wiki/index.php/Startup_Scripts To get startup scripts to run, you will first need to follow these instructions].  I prefer the shell script method which, as the prerequisites list, requires that you you are set up for SSH (or Telnet) and SCP connections to the router.  It also requires that you [http://www.dd-wrt.com/wiki/index.php/Jffs set up the jffs flash file system], so that you have somewhere permanent to store and run the script after reboots.

As with all startup scripts, you should first run this manually from a temporary location to make sure it is working correctly.  Once you have it working properly, you can then make it a startup script (by giving it a '.startup' extension, making it executable (chmod to '700'), and placing it in  /jffs/etc/config/ ([http://www.dd-wrt.com/wiki/index.php/Script_Execution#General_Information or other auto startup directory])).

&lt;pre&gt;
#!/bin/sh

# This script fixes problems with intermittent dropouts of the WiFi radio.
# It pings a Wifi client to monitor when the connection has dropped (2 missed pings)
# It then closes and restarts the WiFi interface to restore WiFi connections.
# Modified (for Atheros chips, e.g., Buffalo DD-WRT WZR-HP-G300NH) from:
# http://www.dd-wrt.com/wiki/index.php/Useful_Scripts#Reset_Wireless_Radio
# (Original script was for Broadcom chip, but Atheros has no 'wl' command)

# A wireless client that should always be up, to monitor (modify this for your own network)
CLIENT_IP=192.168.2.160

# Wireless interface that disappears
# (The command below will generate this automatically
# Should return 'atho' for Atheros hardware)
INTERFACE=`nvram get wl0_ifname`

# seconds between checks
CHECK_EVERY=60

# seconds to wait after failed ping to try again
FAIL_AGAIN=10

# after cycling, wait this many seconds (limits excessive refreshes if the monitored device is off)
AFTER_CYCLE=9000

# Client must be up before starting main loop
while true
do
  if ping -c 1 ${CLIENT_IP} &gt;/dev/null
  then
    echo &quot;${CLIENT_UP} ok - begining main loop&quot;
    break
  fi
done

# main script to restart wireless interface
while sleep ${CHECK_EVERY}
do
  if ping -c 1 ${CLIENT_IP} &gt;/dev/null
  then
    echo &quot;${CLIENT_IP} ok&quot;
  else
    echo &quot;${CLIENT_IP} dropped one&quot;
    sleep ${FAIL_AGAIN}
    if ! ping -c 1 ${CLIENT_IP} &gt;/dev/null
    then
      echo &quot;${CLIENT_IP} dropped two, restarting ${INTERFACE} (WiFi)&quot;
      # wl -i ${INTERFACE} down  **** NO wl command for Atheros hardware, replace
      ifconfig ${INTERFACE} down
      sleep 3
      # wl -i ${INTERFACE} up
      ifconfig ${INTERFACE} up
      sleep ${AFTER_CYCLE}
    fi
  fi
done 2&gt;&amp;1
&lt;/pre&gt;

===Alternate WiFi Dropout Fix===
My WiFi dropouts are always preceded by the following message in /var/log/messages

user.warn kernel: Sending cwmmode action frame to ff:ff:ff:ff:ff:ff

I wrote a simple script to look for this string in the logs and restart the WiFi interface. It looks for the string every 56 seconds in the current 10 minute interval of logs. For example, when run at 11:47, it will look for the string from 11:40 on. If found, it will restart the interface and sleep for 10 minutes before checking again. I find this triggers around every other day. 

After enabling Syslogd under Services-&gt;Services-&gt;System Log, with no remote server specified

With ssh or telnet access, run the following command and then reboot the router

&lt;pre&gt;
nvram set rc_startup='while sleep 57; do if grep ^&quot;`date  +&quot;%b %e %H:%M&quot;|cut -c1-11`&quot; /var/log/messages|fgrep ff:ff:ff:ff:ff:ff &gt; /dev/null ; then ifconfig ath0 down; sleep 4; ifconfig ath0 up; logger &quot;wifi hang, restarting&quot;; sleep 542; fi; done'
&lt;/pre&gt;
Please read the previous WiFi fix for more details on scripting options.

===Recovery===
tested and verfied........There is a easy process to unbrick your router, tested on wzr-hp-g300nh v1,it was tested under the following brick conditions
1) flashing green router light constant
2)blinking red diag light
3)solid red diag light
 and it works, so if you follow these instructions step by step you will be back in business.This was done in windows 7 ultimate.

How to set up a TFTP environment in Windows Vista/7:


1) Set up your network on the Laptop/Desktop.  The boot environment uses an IP of 192.168.11.1 on the router, regardless of what 
you have it set to in OpenWRT.  Set the NIC card on the Laptop/Desktop to 192.168.11.2 for the IP, 255.255.255.0 for the Subnet
 Mask and 192.168.11.1 for the Gateway.

2) Set a static arp entry.  The arp command wouldn't work for me to set a static entry, apparently it's a bug in windows that will happen occasionally.  Instead, I needed to use netsh.  Open a command prompt as an administrator (right click on command prompt and select run as administrator).  After a command prompt is open, type the following command: netsh -c &quot;interface ipv4&quot; .  Use the quotes and hit enter after typing this.  It will bring you to a &quot;netsh interface ipv4&gt;&quot; command prompt.  Once here 
type the following: set neighbors &quot;Local Area Connection&quot; 192.168.11.1 02-aa-bb-cc-dd-1a .  &quot;Local Area Connection&quot; is the name of the NIC card you configured for the 192.168.11.2 address earlier.  Use the quotes.  The name can be found in network connections in the control panel, this is the only part of the command that might differ for you, though it shouldn't if you only have one NIC in your system.  Hit enter after typing this command.  

3) Verify the arp entry by typing arp -a, you should see a static entry for 192.168.11.1 with a MAC of 02-aa-bb-cc-dd-1a.  If you screwed up the command delete it using: arp –d 192.168.11.1 or if you screwed up the IP address type the incorrect IP address there instead.  This in essence gives you a
free pass through the door you cracked open earlier.  You don’t need to ask for directions to do anything so to speak, you have a map to the destination.

4) Install TFTP client.  Go into control panel, program and features, click on turn windows features on or off.  Scroll down 
until you see TFTP client, check this box and hit OK.  After it finishes installing reboot your Laptop/Desktop.


So now that you have a environment conducive to flashing, the real “fun” begins.

download the openwrt-ar71xx-wzr-hp-g300nh-squashfs-tftp.bin firmware: 


Open command prompt and change directory to the download location.  In my case “cd c:\users\username\desktop” without the
 quotes.  Type: tftp -i 192.168.11.1 PUT openwrt-ar71xx-wzr-hp-g300nh-squashfs-tftp.bin .  Don’t hit enter yet though.  
Unplug the power from your router and plug it back in again, immediately hit the enter key on your desktop/laptop.  Apparently,during boot up the router waits for a short period to see if it should accept a new firmware package, this is your window of
opportunity to upload the openwrt firmware. It should only take about a second to finish the upload, DO NOT touch your router,
 walk away from it for 15 minutes.  Do not believe any of the lights on the router.  They are lying to you, they are begging for
 you to brick the router.  When you come back you MIGHT be in good shape, change your IP to 192.168.1.1 (no need to delete the
 arp entry yet) and try to telnet into it.  If you can, change the password using the passwd command, exit the telnet session 
and restart the router.  You should be able to get to the web interface (192.168.1.1).  If you can’t do any of this try holding 
down the reset button for 30 seconds, then unplug the power, release the button and hold again for another 30, plug the power
 in, release the button and hold for another 30.  If all else fails try this entire step again and wait 15 more minutes. 
 
That’s it, you should be in good shape with openwrt.  The next step is to get something far more user friendly loaded onto the 
device.


Download the wzr-hp-g300nh-dd-wrt-webupgrade-MULTI.bin from http://www.dd-wrt.com/site/support/router-database and place it on
 your desktop.  Also download the windows version of “DD” from http://www.chrysocome.net/dd and place it on your desktop.  Heck,while you are in the downloading mood go ahead and grab the original firmware for the Buffalo, don’t bother with Buffalo’s site for this one though because you won’t find it.  Register and log in to the dd-wrt forums and download it from this link: http://www.dd-wrt.com/phpBB2/download.php?id=13418.  Might as well grab the latest firmware from Buffalo.
Got everything?  Good, this is the home stretch to a functional router.

Open a command prompt and change directory to your desktop were all the goodies are.  Type the following: dd bs=28 skip=1 if= (if u cant do this just rename the file to firmware.bin)
 wzr-hp-g300nh-dd-wrt-webupgrade-MULTI.bin of=firmware.bin .  This is stripping the encrypted header off the firmware and outputting the file as firmware.bin, if you don’t do this the flash will not succeed.

Now to flash the router to our hacked up firmware.bin.  Follow the same steps as before when flashing the squashfs firmware above but use the command: tftp -i 192.168.11.1 PUT firmware.bin.  Yes, you really do need to walk away from the router for an extended period of time, yes, those lights are still lying to you.

Once done you now have dd-wrt up and running.  I wouldn’t call it entirely functional though, it wasn’t stable enough to leave as the production firmware (it locks up just trying to save certain settings) and would go out to lunch if left running for a few hours.  But that’s ok because it serves as a stepping stone to a reliable and useable firmware.

At this point you can actually use the web interface to upgrade to the wzrg300nh_original.bin you downloaded from the dd-wrt forums, it will take quite a bit of time to complete this flash.  Once this is done you can upgrade to the latest official
release from Buffalo.

That’s it!  You’re done!  After all this I can say without a doubt the original firmware is the most “reliable” and rather feature packed.  DD-WRT is buggy and doesn’t really offer anything over the stock firmware.  I would have never been able to do
 dev work without OpenWRT though, great firmware, terrible support for this router.  I did what I needed to do on it though and learned a lot of useful information along the way so it was a positive experience, downright maddening but still positive

[[Category:English Documentation]]</text>
      <sha1>7ukqjo8oelhhup9a8o7geaq5v5xhmmo</sha1>
    </revision>
  </page>